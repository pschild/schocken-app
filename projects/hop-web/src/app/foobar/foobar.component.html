<div class="table-container">
  <ng-container *ngIf="activePlayers$ | async as activePlayers; else loadingSpinner">
    <table *ngIf="roundEventsByPlayer$ | async as roundEventsByPlayer; else loadingSpinner">
      <tr>
        <th></th>
        <th *ngFor="let player of activePlayers">{{player.name}}</th>
      </tr>
      <tr *ngIf="gameEventsByPlayer$ | async as gameEventsByPlayer">
        <td>Festst.:</td>
        <td *ngFor="let player of activePlayers">
          <hop-foobar-cell
            [playerEvents]="gameEventsByPlayer.eventsByPlayer[player._id]"
            [playerId]="player._id"
            (removeEvent)="onRemoveGameEvent($event, player._id)"
          ></hop-foobar-cell>
          <button (click)="showGameEventTypeDialog(player)">+</button>
        </td>
      </tr>
      <tr *ngFor="let item of roundEventsByPlayer; let i = index">
        <td>Rd. {{i + 1}}</td>
        <td *ngFor="let player of activePlayers">
          <hop-foobar-cell
            [playerEvents]="item.eventsByPlayer[player._id]"
            [roundId]="item.roundId"
            [playerId]="player._id"
            (removeEvent)="onRemoveRoundEvent($event, item.roundId, player._id)"
          ></hop-foobar-cell>
          <button (click)="showRoundEventTypeDialog()">+</button>
        </td>
      </tr>
      <tr>
        <td>
          <button>Rd. {{roundEventsByPlayer.length + 1}}</button>
        </td>
      </tr>
      <tr *ngIf="sums$ | async as playerSums">
        <td>&sum;</td>
        <td *ngFor="let player of activePlayers">
          {{playerSums[player._id] || 0 | number:'1.2'}}
        </td>
      </tr>
    </table>
  </ng-container>
  <ng-template #loadingSpinner>
    <mat-spinner></mat-spinner>
  </ng-template>
</div>